DECLARE @dt1 DATETIME
DECLARE @i INT
DECLARE @s CHAR(40)
DECLARE @hm1 INT
DECLARE @hm2 INT
SELECT @dt1=GETDATE()
SELECT @hm1=DATEPART(hh,@dt1)*3600000+DATEPART(mi,@dt1)*60000+DATEPART(ss,@dt1)*1000+DATEPART(ms,@dt1)

--此行将用测试命令替代(单记录插入)
SELECT @i=DATEPART(ms,@dt1)
INSERT INTO itb1(rq,srq,hh,mm,ss,num)
VALUES(GETDATE(),CAST(GETDATE() AS VARCHAR(20)),
DATEPART(hh,GETDATE()),DATEPART(mi,GETDATE()),
DATEPART(SS,GETDATE()),CAST(RAND(@i)*100 AS NUMERIC(12,3)))


SELECT @dt1=GETDATE()
SELECT @hm2=DATEPART(hh,@dt1)*3600000+DATEPART(mi,@dt1)*60000+DATEPART(ss,@dt1)*1000+DATEPART(ms,@dt1)-@hm1
SELECT @s='time--'+CONVERT(char(10),@hm2)
RAISERROR(@s,16,1)