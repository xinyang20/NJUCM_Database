<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>分配任务</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <div class="navbar">
        <span>中药管理系统 - 工厂管理员</span>
        <a href="/">返回仪表盘</a>
    </div>
    <h1>分配任务</h1>
    <form method="POST">
        <label for="order_id">选择订单:</label>
        <select name="order_id" id="order_id">
            {% for order in orders %}
            <option value="{{ order.decoction_id }}">订单ID: {{ order.decoction_id }}</option>
            {% endfor %}
        </select>
        <br>
        <label for="worker_id">选择工人:</label>
        <select name="worker_id" id="worker_id">
            {% for worker in workers %}
            <option value="{{ worker.id }}">{{ worker.username }}</option>
            {% endfor %}
        </select>
        <br>
        <button type="submit">分配任务</button>
    </form>

    <h2>已分配的任务</h2>
    <table class="data-table">
        <thead>
            <tr>
                <th>任务ID</th>
                <th>工人用户名</th>
                <th>任务状态</th>
            </tr>
        </thead>
        <tbody>
            {% for task in assigned_tasks %}
            <tr>
                <td>{{ task.decoction_id }}</td>
                <td>{{ task.formulation_staff }}</td>
                <td>
                    {% if task.soaking_staff == None %}
                    配方中
                    {% elif task.decoction_staff == None %}
                    浸泡中
                    {% elif task.print_staff == None %}
                    煎药中
                    {% else %}
                    已完成
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</body>
</html>
